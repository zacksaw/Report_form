///Narrative//Sex is var is_sex = ""if (this.getField("Check Box14").value == "Yes"){is_sex = "female";}else if (this.getField("Check Box15").value == "Yes"){is_sex = "male";}else {is_sex = "";}//calculate agevar is_age = "";dobValue = this.getField("Date of Birth").value;if (dobValue!="") {dob = util.scand("mm/dd/yyyy", dobValue);now = new Date();age = now.getFullYear() - dob.getFullYear();if (now.getMonth() < dob.getMonth())age--;else if (now.getMonth()==dob.getMonth() && now.getDate() < dob.getDate())age--;var is_age = age;}//last administration var dates = [this.getField("Date of Last TreatmentRow1").value,this.getField("Date of Last TreatmentRow2").value,this.getField("Date of Last TreatmentRow3").value,this.getField("Date of Last TreatmentRow4.0").value,this.getField("Date of Last TreatmentRow4.1").value,this.getField("Date of Last TreatmentRow4.2").value];function max_date(all_dates) {var max_dt = all_dates[0],  max_dtObj = new Date(all_dates[0]);all_dates.forEach(function(dt, index)  {  if ( new Date( dt ) > max_dtObj)  {  max_dt = dt;  max_dtObj = new Date(dt);  }  }); return max_dt;  }latest_date = (max_date(dates));//Which hospitalvar hospital = ""if (this.getField("Check Box44").value == "Yes"){hospital = ("NYU Langone Health");}else {(hospital = this.getField("hospital").value);}//medications listvar row_1_language = ""if (this.getField("DrugRow1").value!=""){row_1_language = "The MD decided to " + this.getField("Dropdown3.0").value + " " + this.getField("DrugRow1").value ;}else {row_1_language = "";}var row_2_language = ""if (this.getField("DrugRow2").value!=""){row_2_language = ", " + this.getField("Dropdown3.1").value + " " + this.getField("DrugRow2").value;}else {row_2_language = "";}var row_3_language = ""if (this.getField("DrugRow3").value!=""){row_3_language = ", " + this.getField("Dropdown3.2").value + " " + this.getField("DrugRow3").value;}else {row_3_language = "";}var row_4_language = ""if (this.getField("DrugRow4.0").value!=""){row_4_language = ", " + this.getField("Dropdown3.3.0").value + " " + this.getField("DrugRow4.0").value;}else {row_4_language = "";}var row_5_language = ""if (this.getField("DrugRow4.1").value!=""){row_5_language = ", " + this.getField("Dropdown3.3.1").value + " " + this.getField("DrugRow4.1").value;}else {row_5_language = "";}var row_6_language = ""if (this.getField("DrugRow4.2").value!=""){row_6_language = ", " + this.getField("Dropdown3.3.2").value + " " + this.getField("DrugRow4.2").value;}else {row_6_language = "";}{event.value = ("Subject " + this.getField("Subject ID").value + " is a "+ is_age + " y/o " + is_sex + " who presented to " + hospital + " with grade " + this.getField("Grade").value + " " + this.getField("Event Description").value+ " on " + this.getField("Event Start Date").value + ".\n\n" + "Subject signed consent on " + this.getField("Date Informed Consent Obtained").value + " for study " + this.getField("Text1").value + ".\n\n" + "The most recent administration of investigational product(s) was on " + latest_date + ".\n" + row_1_language + row_2_language + row_3_language + row_4_language + row_5_language + row_6_language + "." );}